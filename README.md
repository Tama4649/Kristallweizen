Kristallweizen（評価関数のみ）  
  
これは第29回世界コンピュータ将棋選手権で準優勝したKristallweizenの評価関数です。  
評価関数はNNUE型で作成されており、やねうら王にマージされているNNUEのディフォルトの  
NN構成と同じ、HalfKP-256x2-32-32となっています。  
  
使用環境  
  
やねうら王Ver4.83のNNUE版を実行できる環境であれば、評価関数をそのまま差し替えるだけで  
動作します。  
  
もしものために、実行バイナリも用意しました。 
   
Kristallweizen-wcsc29-avx2.exe  
Kristallweizen-wcsc29-sse42.exe  
  
この実行バイナリを利用する際には、評価関数ファイル名をnn.binからbeer.binに変更して  
ご利用ください。（ささやかなネタですｗ）  
  
～avx2.exeのほうで動かなかったら、～sse42.exeのほうで試してみてください。  
  
その他  
  
強さに関しては、選手権ギリギリまで学習を粘っていた関係で正直よくわかっていません。w  
まぁ、準優勝するぐらいは強かったのでしょうが……。^^;  
選手権後にほんのちょっとだけ illqha4 + やねうら王と1億ノード指定、定跡なしで対局させて  
みましたが、10局やって 4勝 4敗 2分、どちらの評価関数も勝ったのは先手番のみという極端な  
結果が出ました。これは私の計測条件がおかしい可能性もありますので、どなたか検証して  
いただけると助かります。  

また、短時間対局では異様に弱いことも付記しておきます。最低でも5000万ノードは読ませないと  
ダメダメでした。  
  
弱くてがっかりしたらすみません。そうだったらそれは探索部がちょ～優秀だったせいで準優勝  
したのだと思ってください。  
  
  
2019.9.6  
Kristallweizen改（評価関数のみ）リリース  
  
ちょっとした実験で作成してみた評価関数です。思いの外いい感じだったので公開します。  
  
Kristallweizen_kai.zip  
  
細かく検証したわけではないのですが、試しに水匠改と定跡なし1600万ノードで10局やって  
7勝2敗1分だったので、潤沢なリソースをお持ちの有志の方々に検証いただけると幸いです。  
  
  
2019.9.10  
Kristallweizen改（評価関数のみ）その２ リリース  
  
Kristallweizen_kaiV0.2.zip  
  
何をやっているのかわからないと思いますので、タネ明かししちゃいます。  
これはNNUEキメラのテストです。NNUEキメラツールができたので、実験してます。^^  
先にアップしたのは、白ビールと水匠改を50%ずつ単純にキメラしたものです。  
今回アップしたのは、またもや単純に白ビールとGrampus3を50%でキメラしたものです。  
Grampus3にはやり7勝2敗1分でした。  
  
前回アップしたものの指し手を見ているとわかるのですが、白ビールの暴発気味の攻めが、  
水匠改の冷静さに抑え込まれて我慢しているところがけっこうあります。これが狙った効果です。  
  
NNUEをキメラすることはみんな一度は考えることです。が、重みを単純に足し引きしても、  
KPPTと同じような効果は得られません。それは、KPPTと違ってNNUEは駒の配置に対応した  
全結合ニューロンのアフィン変換の末に出てきた値が評価値ですから、狙った筋のニューロンに  
加点するのはなかなか難しいのです。（やね師匠も「誰かやってください」と投げていましたw）
  
でも裏を返せば、学習による重みの加点方法はやねうら王で学習するかぎり変わりませんから、  
学習の平均化は行えるわけです。つまりNNUEの学習正則化には利用できるわけです。  
  
やってみるとわかりますが、上位の評価関数は「ここが最善！」という筋はほぼ共通しており、  
評価値の発火点（この駒とこの駒がここにあったら加点）がほぼ共通になっています。そういった  
筋はどちらも大きい重みがついていますから、そのまま最善だと認識します。  
この状態で全く読みにない発火点がキメラされると、なかった発火点が重み半分でも計算対象に  
上がってくることになり、評価値は変わってきます。対抗形が苦手の白ビールに振電改を混ぜれば、  
振った際のキモみたいなものが白ビールに取り込まれるわけです。  
これをベースに強化学習していけば、学習にかかるかなりの時間が軽減できることはおわかり  
いただけるかと思います。  
  
おまけ情報  
白ビールとillqha4をキメラしてみると、わけがわからないほど弱くなります。まだ原因は不明  
です。学習のベースにしてよいものかどうかもわかりません。。。  
  
  
以上  
